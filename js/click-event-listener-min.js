/* Copyright (c) 2022, svoboda18.tk - SaMad SegMane. */
!function(){"use strict";var clickForms=select(".click-event",!0);let click_event_fired=0;for(const thisForm of clickForms)for(const formChild of thisForm.children)formChild.classList.contains("click-event-btn")&&on("click",formChild,click_event_action=>{if(click_event_action.preventDefault(),!click_event_fired){click_event_fired=1;const formData=new FormData;var key=thisForm.getAttribute("data-recaptcha-site-key");const click_is_portfolio=thisForm.getAttribute("data-click-is-portfolio");click_event_action=thisForm.getAttribute("data-click-event-action");const click_event_errdiv=thisForm.querySelector(".error-message");click_event_errdiv.innerHTML="Please wait..",click_event_errdiv.style.color="#45505b",click_event_errdiv.style.background="none",click_event_errdiv.classList.add("d-block"),click_event_action?(click_is_portfolio&&(formData.set("click-portfolio-detail-filter",thisForm.getAttribute("data-portfolio-filter")),formData.set("click-portfolio-detail-element",thisForm.getAttribute("data-portfolio-element"))),gre(key,click_event_action+"_click_event",greObj=>{"object"==typeof greObj?(formData.set("grecaptcha-response",greObj.token),click_event(thisForm,"assets/scripts/click-event.php",formData,click_is_portfolio)):displayError(thisForm,greObj)})):displayError(thisForm,"The form click-event-action property is not set!")}});const click_event=(thisForm,action,formData,click_is_portfolio=0)=>{var date=isMobile()?dte(0,0,1):dte();formData.set("click-event-post-date",date),fetch(action,{method:"POST",body:formData,headers:{"X-Requested-With":"XMLHttpRequest"}}).then(ret=>{if(click_event_fired=0,thisForm.querySelector(".error-message").classList.remove("d-block"),click_is_portfolio&&select("html").classList.contains("glightbox-open"))return"OK";if(click_is_portfolio&&portfolioDetailsLightbox.open(),ret.ok)return ret.text();throw new Error(`${ret.status} ${ret.statusText} `+ret.url)}).then(data=>{if("OK"!==data.trim())throw new Error(data||"Unexpected error")}).catch(err=>displayError(thisForm,err))},displayError=(thisForm,err)=>{let errorDiv=thisForm.querySelector(".error-message");errorDiv.innerHTML=err,errorDiv.style.color="#ed3c0d",errorDiv.style.background="#fff",errorDiv.classList.add("d-block"),click_event_fired=0}}();