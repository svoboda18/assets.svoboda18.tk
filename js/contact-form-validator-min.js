/* Copyright (c) 2022, svoboda18.tk - SaMad SegMane. */
!function(){"use strict";var contactForms=select(".contact-form",!0);const contactFormElements=["name","email","subject","message"];1<contactForms.length&&console.log("\n","Warning: more then one contact form and this is not expected!");for(const thisForm of contactForms){on("submit",thisForm,checkValid=>{checkValid.preventDefault(),thisForm.querySelector(".loading").classList.add("d-block"),thisForm.querySelector(".error-message").classList.remove("d-block"),thisForm.querySelector(".sent-message").classList.remove("d-block");const action=thisForm.getAttribute("action");var key=thisForm.getAttribute("data-recaptcha-site-key"),checkValid=verifiyElements(thisForm,contactFormElements);const formData=new FormData(thisForm);action?checkValid.areValid?gre(key,"contact_submit",greObj=>{"object"==typeof greObj?(formData.append("grecaptcha-response",greObj.token),contact_submit(thisForm,action,formData)):displayError(thisForm,greObj)}):displayError(thisForm,checkValid.errMessage):displayError(thisForm,"The form action property is not set!")});for(const event of["keydown","keyup"])thisForm.addEventListener(event,()=>{for(const Element of contactFormElements)""==thisForm.elements[Element].value?thisForm.querySelector(".form-control-"+Element).innerHTML=null:thisForm.querySelector(".form-control-"+Element).innerHTML=thisForm.elements[Element].getAttribute("placeholder")+": ";verifiyElements(thisForm,contactFormElements)})}const verifiyElements=(thisForm,Elements)=>{
/*!regex validation by svoboda18!*/
const emailRegex=/^[^@\s]+[^@.]@(?!.*@)[\w[-]+[^-]\./m,emailRegexExt=/^(?!.*\.{2}|.*"{2}|\.)/m,emailUserRegex=/^[\w!#$%&"*+/='?^`{|}~.-]+@/im,emailDomainRegex=/@(?!\.|-|_)[a-z0-9.-]+$/i,emailTLDRegex=/\.[a-z]{2,16}$/im,emailDomainIPRegex=/@(\d{1,3}\.){3}\d{1,3}(:\d{1,3})?$/m,emailDomainIPRegexExt=/@\[(\d{1,3}\.){3}\d{1,3}(:\d{1,3})?]$/m;var s;let thisFormValid=1,thisFormEmailStatus=1,thisFormMessage;for(const Element of Elements)("email"===Element?((s=thisForm.elements[Element].value).includes('"')?s.charCount('"')%2==0:1)&&emailUserRegex.test(s)&&(emailDomainRegex.test(s)&&emailTLDRegex.test(s)||emailDomainIPRegex.test(s)||emailDomainIPRegexExt.test(s))&&emailRegex.test(s)&&emailRegexExt.test(s):thisForm.elements[Element].value)?(thisForm.elements[Element].classList.remove("form-control-error"),thisForm.elements[Element].classList.add("form-control-success")):(thisForm.elements[Element].classList.remove("form-control-success"),thisForm.elements[Element].classList.add("form-control-error"),"email"===Element?[thisFormValid,thisFormEmailStatus]=[thisForm.elements[Element].value?1:0,0]:thisFormValid=0);return thisFormMessage=thisFormValid?thisFormEmailStatus?null:"Error: Email is invalid.":"Error: Check your input.",{areValid:thisFormValid*thisFormEmailStatus,errMessage:thisFormMessage}},contact_submit=(thisForm,action,formData)=>{fetch(action,{method:"POST",body:formData,headers:{"X-Requested-With":"XMLHttpRequest"}}).then(ret=>{if(ret.ok)return ret.text();throw new Error(`${ret.status} ${ret.statusText} `+ret.url)}).then(data=>{if(thisForm.querySelector(".loading").classList.remove("d-block"),"OK"!=data.trim())throw new Error(data||"Unexpected error while sending email!");for(const Element of contactFormElements)thisForm.elements[Element].classList.remove("form-control-success"),thisForm.elements[Element].classList.remove("form-control-error"),thisForm.querySelector(".form-control-"+Element).innerHTML=null;thisForm.querySelector(".sent-message").classList.add("d-block"),thisForm.reset()}).catch(err=>displayError(thisForm,err))},displayError=(thisForm,error)=>{var errorElement=error.toString().split(" ")[1].split(" ")[0].toLowerCase().trim();-1!==contactFormElements.indexOf(errorElement)&&(thisForm.elements[errorElement].classList.remove("form-control-success"),thisForm.elements[errorElement].classList.add("form-control-error")),thisForm.querySelector(".loading").classList.remove("d-block"),thisForm.querySelector(".error-message").innerHTML=error,thisForm.querySelector(".error-message").classList.add("d-block")}}();